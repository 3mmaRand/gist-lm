<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Single linear regression | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</title>
<meta name="author" content="Emma Rand">
<meta name="description" content="This is probably the one general linear model you have applied using lm() previously and it is covered here as revision and make more clear links between regression, t-tests and ANOVA.  4.1...">
<meta name="generator" content="bookdown 0.24.1 with bs4_book()">
<meta property="og:title" content="Chapter 4 Single linear regression | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users">
<meta property="og:type" content="book">
<meta property="og:url" content="https://3mmarand.github.io/gist-lm/single-regression.html">
<meta property="og:image" content="https://3mmarand.github.io/gist-lm/images/hex-s.png">
<meta property="og:description" content="This is probably the one general linear model you have applied using lm() previously and it is covered here as revision and make more clear links between regression, t-tests and ANOVA.  4.1...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Single linear regression | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users">
<meta name="twitter:description" content="This is probably the one general linear model you have applied using lm() previously and it is covered here as revision and make more clear links between regression, t-tests and ANOVA.  4.1...">
<meta name="twitter:image" content="https://3mmarand.github.io/gist-lm/images/hex-s.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0.9000/transition.js"></script><script src="libs/bs3compat-0.3.0.9000/tabs.js"></script><script src="libs/bs3compat-0.3.0.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="assets/book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">INTRODUCTION</li>
<li><a class="" href="revision.html"><span class="header-section-number">1</span> Revision of your Introductory class</a></li>
<li><a class="" href="what-are-linear-models.html"><span class="header-section-number">2</span> What are General Linear Models</a></li>
<li><a class="" href="terminolgy.html"><span class="header-section-number">3</span> Terminolgy</a></li>
<li class="book-part">USING lm() FOR FAMILIAR TESTS</li>
<li><a class="active" href="single-regression.html"><span class="header-section-number">4</span> Single linear regression</a></li>
<li><a class="" href="t-tests-revisit.html"><span class="header-section-number">5</span> t-tests revisited</a></li>
<li><a class="" href="one-way-anova-revisit.html"><span class="header-section-number">6</span> One-way ANOVA revisited</a></li>
<li><a class="" href="two-way-anova-revisit.html"><span class="header-section-number">7</span> Two-way ANOVA revisited</a></li>
<li><a class="" href="summary.html"><span class="header-section-number">8</span> Summary</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="single-regression" class="section level1">
<h1>
<span class="header-section-number">4</span> Single linear regression<a class="anchor" aria-label="anchor" href="#single-regression"><i class="fas fa-link"></i></a>
</h1>
<p>This is probably the one general linear model you have applied using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> previously and it is covered here as revision and make more clear links between regression, <em>t</em>-tests and ANOVA.</p>
<div id="introduction-to-the-example" class="section level2">
<h2>
<span class="header-section-number">4.1</span> Introduction to the example<a class="anchor" aria-label="anchor" href="#introduction-to-the-example"><i class="fas fa-link"></i></a>
</h2>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:lucanus-fig"></span>
<img src="images/640px-Lucanus_cervus_male_top_2.jpg" alt="Male stag beetles Lucanus cervus, have large mandibles that resemble the antlers of a stag and give them their common and scientific name (Cervus is a genus of deer). By Simon A. Eugster - Own work, CC BY 3.0, https://commons.wikimedia.org/w/index.php?curid=7790887" width="80%"><p class="caption">
Figure 4.1: Male stag beetles <em>Lucanus cervus</em>, have large mandibles that resemble the antlers of a stag and give them their common and scientific name (<em>Cervus</em> is a genus of deer). By Simon A. Eugster - Own work, CC BY 3.0, <a href="https://commons.wikimedia.org/w/index.php?curid=7790887" class="uri">https://commons.wikimedia.org/w/index.php?curid=7790887</a>
</p>
</div>
<p>The concentration of Juvenile growth hormone in male stag beetles (<em>Lucanus cervus</em>) is known to influence mandible growth. See Figure <a href="single-regression.html#fig:lucanus-fig">4.1</a></p>
<p>Groups of ten stag beetles were treated with different concentrations of Juvenile growth hormone (pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup>) and their average mandible size (mm) determined. The data are in <a href="data-raw/stag.txt">stag.txt</a>. Juvenile hormone is has been set by the experimenter and we would expect mandible size to be normally distributed.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
jh
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mand
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.56
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.22
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
0.48
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.86
</td>
</tr>
<tr>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
0.68
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
1.18
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
1.44
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
1.32
</td>
</tr>
<tr>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
1.66
</td>
</tr>
<tr>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
1.23
</td>
</tr>
<tr>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
1.17
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="key">
<p>There are 2 variables: <code>jh</code>, the concentration of Juvenile growth hormone and <code>mand</code>, the average mandible size (mm) of 10 stag beetles</p>
</div>
<p>We will import the data with the <code>read_table2()</code> function from the <strong><code>readr</code></strong> package and plot it with <code>ggplot()</code> from the <strong><code>ggplot2</code></strong> package. Both packages are part of the tidyverse.</p>
<p>Import the data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stag</span> <span class="op">&lt;-</span> <span class="fu">read_table2</span><span class="op">(</span><span class="st">"data-raw/stag.txt"</span><span class="op">)</span></code></pre></div>
<p>Visualising our data before any further analysis is sensible. In this case, it will help us determine if any relationship between the two variables is linear.
A simple scatter plot is appropriate.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">stag</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">jh</span>, y <span class="op">=</span> <span class="va">mand</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="single-linear-regression_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto auto auto 0;">
The relationship between the two variables looks roughly linear. So far, common sense suggests the assumptions of regression are met.</div>
</div>
<div id="applying-and-interpreting-lm" class="section level2">
<h2>
<span class="header-section-number">4.2</span> Applying and interpreting <code>lm()</code><a class="anchor" aria-label="anchor" href="#applying-and-interpreting-lm"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function is used to build the regression model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stag</span>, <span class="va">mand</span> <span class="op">~</span> <span class="va">jh</span><span class="op">)</span></code></pre></div>
<p>This can be read as: fit a linear of model of mandible size explained by the concentration of Juvenile growth hormone.</p>
<p>Printing <code>mod</code> to the console will reveal the estimated model parameters (coefficients) but little else:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = mand ~ jh, data = stag)</span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co"># (Intercept)           jh  </span>
<span class="co">#     0.41934      0.00646</span></code></pre></div>
<p><span class="math inline">\(\beta_{0}\)</span> is labelled <code>(Intercept)</code> and <span class="math inline">\(\beta_{1}\)</span> is labelled <code>jh</code>. Thus, the equation of the line is:</p>
<center>
<span class="math inline">\(mand\)</span> = 0.419 + 0.006<span class="math inline">\(jh\)</span>
</center>
<p>More information, including statistical tests of the model and its parameters, is obtained by using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = mand ~ jh, data = stag)</span>
<span class="co"># </span>
<span class="co"># Residuals:</span>
<span class="co">#     Min      1Q  Median      3Q     Max </span>
<span class="co"># -0.3860 -0.2028 -0.0975  0.1503  0.6069 </span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="co"># (Intercept)  0.41934    0.13943    3.01   0.0094 **</span>
<span class="co"># jh           0.00646    0.00158    4.08   0.0011 **</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># Residual standard error: 0.292 on 14 degrees of freedom</span>
<span class="co"># Multiple R-squared:  0.543,   Adjusted R-squared:  0.51 </span>
<span class="co"># F-statistic: 16.6 on 1 and 14 DF,  p-value: 0.00113</span></code></pre></div>
<p>The <code>Coefficients</code> table gives the estimated <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> again but along with their standard errors and tests of whether the estimates differ from zero. The estimated value for the intercept is 0.419 <span class="math inline">\(\pm\)</span> 0.139 and this differs significantly from zero (<span class="math inline">\(p\)</span> = 0.009). The estimated value for the slope is 0.006 <span class="math inline">\(\pm\)</span> 0.002, also differs significantly from zero (<span class="math inline">\(p\)</span> = 0.001).</p>
<p>The three lines at the bottom of the output give information about the fit of the model to the data. The <code>Multiple R-squared</code> gives the proportion of the variance in the response which is explained by the model. In our case, 0.543 of the variance in mandible length is explained by the model and this is a significant proportion of that variance (<span class="math inline">\(p\)</span> = 0.001).</p>
<p>The <em>p</em>-value for the model and the <em>p</em>-value for the slope are the same in a single linear regression because, except for the intercept, there is only one parameter (the slope) in the model. Linear models in the form of a two-sample <em>t</em>-test also estimate just one parameter and its <em>p</em>-value will also equal the model <em>p</em>-value. This is <strong>not</strong> the case for other linear models.</p>
</div>
<div id="link-to-chapter-2.1" class="section level2">
<h2>
<span class="header-section-number">4.3</span> Link to Chapter 2.1<a class="anchor" aria-label="anchor" href="#link-to-chapter-2.1"><i class="fas fa-link"></i></a>
</h2>
<p>The estimated coefficients tell us mandible size is predicted to be 0.419 when Juvenile growth hormone is zero and increases by 0.006 mm for each pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup> of Juvenile growth hormone.</p>
<p>At a Juvenile growth hormone of 1 pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup> the mandible is predicted to be 0.419 + 0.006 = 0.426 mm.</p>
<p>At 2 pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup> the predicted mandible size is 0.419 + 0.006 + 0.006 = 0.432 mm.</p>
<p>In general mandible size is: <span class="math inline">\(\beta_{0}\)</span> + <span class="math inline">\(x\times\beta_{0}\)</span> mm at <span class="math inline">\(x\)</span> pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup>. See Figure <a href="single-regression.html#fig:stag-annotated">4.2</a> for a version of Figure <a href="what-are-linear-models.html#fig:lm-annotated">2.2</a> annotated with values from this example.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:stag-annotated"></span>
<img src="images/stag_reg_eg.svg" alt="The model annotated with values from the stag beetle example. The measured response values are in pink, the predictions are in green, and the residuals, are in blue. One example of a measured value, a predicted value and the residual is shown for a Juvenile hormone of 130 pg\(\mu\)l-1. The estimated model parameters, \(\beta_{0}\) and \(\beta_{1}\) are indicated. Compare to Figure 2.2." width="80%"><p class="caption">
Figure 4.2: The model annotated with values from the stag beetle example. The measured <span style=" font-weight: bold;    color: #d264c0 !important;">response values are in pink</span>, the <span style=" font-weight: bold;    color: #c0d264 !important;">predictions are in green</span>, and the <span style=" font-weight: bold;    color: #64c0d2 !important;">residuals, are in blue</span>. One example of a measured value, a predicted value and the residual is shown for a Juvenile hormone of 130 pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup>. The estimated model parameters, <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> are indicated. Compare to Figure <a href="what-are-linear-models.html#fig:lm-annotated">2.2</a>.
</p>
</div>
</div>
<div id="getting-predictions-from-the-model" class="section level2">
<h2>
<span class="header-section-number">4.4</span> Getting predictions from the model<a class="anchor" aria-label="anchor" href="#getting-predictions-from-the-model"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function returns the predicted values of the response. To add a column of predicted values to the <code>stag</code> dataframe we use:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stag</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="fu">glimpse</span><span class="op">(</span><span class="va">stag</span><span class="op">)</span>
<span class="co"># Rows: 16</span>
<span class="co"># Columns: 3</span>
<span class="co"># $ jh   &lt;dbl&gt; 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 1~</span>
<span class="co"># $ mand &lt;dbl&gt; 0.56, 0.35, 0.28, 1.22, 0.48, 0.86, 0.68, 0.77, 0.55, 1.18, 0.71,~</span>
<span class="co"># $ pred &lt;dbl&gt; 0.419, 0.484, 0.549, 0.613, 0.678, 0.742, 0.807, 0.871, 0.936, 1.~</span></code></pre></div>
<p>This gives predictions for the actual Juvenile growth hormone concentration values used. If you want predictions for other values, you need to create a data frame of the Juvenile growth hormone values from which you want to predict.
The following creates a dataframe with one column of Juvenile growth hormone values from 0 to 150 in steps of 5:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>jh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="fu">glimpse</span><span class="op">(</span><span class="va">predict_for</span><span class="op">)</span>
<span class="co"># Rows: 31</span>
<span class="co"># Columns: 1</span>
<span class="co"># $ jh &lt;dbl&gt; 0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 8~</span></code></pre></div>
<p>Note that the column is named <code>jh</code> - the same as in the dataset and the model. Its variable type must also match.</p>
<div class="key">
<p>To predict responses for a new set of explanatory variable values, the name and type of explanatory variables in the new set must match those in the model.</p>
</div>
<p>To get predicted mandible sizes for the Juvenile growth hormone values we use:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="va">predict_for</span><span class="op">)</span>
<span class="fu">glimpse</span><span class="op">(</span><span class="va">predict_for</span><span class="op">)</span>
<span class="co"># Rows: 31</span>
<span class="co"># Columns: 2</span>
<span class="co"># $ jh   &lt;dbl&gt; 0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80,~</span>
<span class="co"># $ pred &lt;dbl&gt; 0.419, 0.452, 0.484, 0.516, 0.549, 0.581, 0.613, 0.645, 0.678, 0.~</span></code></pre></div>
</div>
<div id="checking-assumptions-1" class="section level2">
<h2>
<span class="header-section-number">4.5</span> Checking assumptions<a class="anchor" aria-label="anchor" href="#checking-assumptions-1"><i class="fas fa-link"></i></a>
</h2>
<p>The two assumptions of the model can be checked using diagnostic plots. The Q-Q plot is obtained with:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="single-linear-regression_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
<p>This sample is relatively small so we should expect more wiggliness than we saw in 2.2 but this looks OK.</p>
<p>Letâ€™s look at the Residuals vs Fitted plot:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="single-linear-regression_files/figure-html/unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
<p>Again the red line wiggles a little but there is no particular pattern and it appears that the variance is homogeneous along mandible size.</p>
</div>
<div id="creating-a-figure" class="section level2">
<h2>
<span class="header-section-number">4.6</span> Creating a figure<a class="anchor" aria-label="anchor" href="#creating-a-figure"><i class="fas fa-link"></i></a>
</h2>
<p>A suitable figure includes the data themselves and the model fitted:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">stag</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">jh</span>, y <span class="op">=</span> <span class="va">mand</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0</span><span class="op">)</span>,
                           limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">160</span><span class="op">)</span>,
                           name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Juvenile growth hormone (pg"</span>,
                                                   <span class="va">mu</span>,
                                                   <span class="va">l</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span>,
                                                   <span class="st">")"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
                           limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,
                           name <span class="op">=</span> <span class="st">"Mandible length (mm)"</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="single-linear-regression_files/figure-html/fig-reg-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
</div>
<div id="reporting-the-results" class="section level2">
<h2>
<span class="header-section-number">4.7</span> Reporting the results<a class="anchor" aria-label="anchor" href="#reporting-the-results"><i class="fas fa-link"></i></a>
</h2>
<p>There was a significant positive relationship between the concentration of Juvenile growth hormone and mandible length (<span class="math inline">\(\beta_{1}\pm s.e.\)</span>: 0.006 <span class="math inline">\(\pm\)</span> 0.002; <span class="math inline">\(p\)</span> = 0.001). See figure <a href="single-regression.html#fig:fig-reg-report">4.3</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:fig-reg-report"></span>
<img src="single-linear-regression_files/figure-html/fig-reg-report-1.png" alt="Relationship between the concentration of Juvenile growth hormone and mandible length." width="60%"><p class="caption">
Figure 4.3: Relationship between the concentration of Juvenile growth hormone and mandible length.
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="terminolgy.html"><span class="header-section-number">3</span> Terminolgy</a></div>
<div class="next"><a href="t-tests-revisit.html"><span class="header-section-number">5</span> t-tests revisited</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#single-regression"><span class="header-section-number">4</span> Single linear regression</a></li>
<li><a class="nav-link" href="#introduction-to-the-example"><span class="header-section-number">4.1</span> Introduction to the example</a></li>
<li><a class="nav-link" href="#applying-and-interpreting-lm"><span class="header-section-number">4.2</span> Applying and interpreting lm()</a></li>
<li><a class="nav-link" href="#link-to-chapter-2.1"><span class="header-section-number">4.3</span> Link to Chapter 2.1</a></li>
<li><a class="nav-link" href="#getting-predictions-from-the-model"><span class="header-section-number">4.4</span> Getting predictions from the model</a></li>
<li><a class="nav-link" href="#checking-assumptions-1"><span class="header-section-number">4.5</span> Checking assumptions</a></li>
<li><a class="nav-link" href="#creating-a-figure"><span class="header-section-number">4.6</span> Creating a figure</a></li>
<li><a class="nav-link" href="#reporting-the-results"><span class="header-section-number">4.7</span> Reporting the results</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</strong>" was written by Emma Rand. It was last built on September 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
