<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 One-way ANOVA revisited | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</title>
<meta name="author" content="Emma Rand">
<meta name="description" content="In this chapter we again consider an example with one categorical explanatory variable. However, this time it has more than two groups (or levels). We first use the familiar aov() function to...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 6 One-way ANOVA revisited | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users">
<meta property="og:type" content="book">
<meta property="og:url" content="https://3mmarand.github.io/gist-lm/one-way-anova-revisit.html">
<meta property="og:image" content="https://3mmarand.github.io/gist-lm/images/hex-s.png">
<meta property="og:description" content="In this chapter we again consider an example with one categorical explanatory variable. However, this time it has more than two groups (or levels). We first use the familiar aov() function to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 One-way ANOVA revisited | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users">
<meta name="twitter:site" content="@er13_r">
<meta name="twitter:description" content="In this chapter we again consider an example with one categorical explanatory variable. However, this time it has more than two groups (or levels). We first use the familiar aov() function to...">
<meta name="twitter:image" content="https://3mmarand.github.io/gist-lm/images/hex-s.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="assets/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li class="book-part">INTRODUCTION</li>
<li><a class="" href="revision.html"><span class="header-section-number">1</span> Revision of your Introductory class</a></li>
<li><a class="" href="what-are-linear-models.html"><span class="header-section-number">2</span> What are General Linear Models</a></li>
<li><a class="" href="terminolgy.html"><span class="header-section-number">3</span> Terminolgy</a></li>
<li class="book-part">USING lm() FOR FAMILIAR TESTS</li>
<li><a class="" href="single-regression.html"><span class="header-section-number">4</span> Single linear regression</a></li>
<li><a class="" href="t-tests-revisit.html"><span class="header-section-number">5</span> t-tests revisited</a></li>
<li><a class="active" href="one-way-anova-revisit.html"><span class="header-section-number">6</span> One-way ANOVA revisited</a></li>
<li><a class="" href="two-way-anova-revisit.html"><span class="header-section-number">7</span> Two-way ANOVA revisited</a></li>
<li><a class="" href="summary.html"><span class="header-section-number">8</span> Summary</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/3mmaRand/gist-lm">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="one-way-anova-revisit" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> One-way ANOVA revisited<a class="anchor" aria-label="anchor" href="#one-way-anova-revisit"><i class="fas fa-link"></i></a>
</h1>
<p>In this chapter we again consider an example with one categorical explanatory variable. However, this time it has more than two groups (or levels). We first use the familiar <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function to carry out a one-way ANOVA and then use that understanding to help us understand the output of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. We will also make predictions from the model and report on our results.</p>
<div id="introduction-to-the-example-2" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Introduction to the example<a class="anchor" aria-label="anchor" href="#introduction-to-the-example-2"><i class="fas fa-link"></i></a>
</h2>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:weddell-fig"></span>
<img src="images/Baby_Weddell_Seal.jpg" alt="Baby Weddell Seals are very cute. By Photo © Samuel Blanc, CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=3877642" width="80%"><p class="caption">
Figure 6.1: Baby Weddell Seals are very cute. By Photo © Samuel Blanc, CC BY-SA 3.0, <a href="https://commons.wikimedia.org/w/index.php?curid=3877642" class="uri">https://commons.wikimedia.org/w/index.php?curid=3877642</a>
</p>
</div>
<p>The myoglobin concentration of skeletal muscle (in grams per kilogram of muscle) for three species of seal (see Figure <a href="one-way-anova-revisit.html#fig:weddell-fig">6.1</a>) is given in <a href="data-raw/seal.txt">seal.txt</a>.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
species
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
myoglobin
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
49.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
51.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
41.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
45.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
39.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
43.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
55.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
66.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
56.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
47.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
51.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
50.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
53.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
35.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
45.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
38.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
50.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
49.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
41.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
41.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
45.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
48.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
57.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
61.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
48.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
62.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
38.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
40.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
67.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
48.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
55.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
40.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
46.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
29.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
52.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
37.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
42.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
51.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
48.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
44.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
58.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
45.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
37.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
39.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
45.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
51.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
38.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
36.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
49.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
62.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
45.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
57.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
42.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
40.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
31.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
42.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
46.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
39.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
50.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
34.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
56.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
48.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
37.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
42.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
27.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
43.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
42.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
29.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
42.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
58.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
32.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
38.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
52.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
53.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
42.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
46.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
44.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
49.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
40.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
41.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
38.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
35.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
48.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
33.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
38.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
26.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
50.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
42.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
47.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
41.6
</td>
</tr>
</tbody>
</table></div>
</div>
<p>The data were collected to determine whether muscle myoglobin differed between species.</p>
<div class="key">
<p>There are 2 variables.
<code>seal</code> is the explanatory variable; it is categorical with 3 levels, <code>Bladdernose Seal</code>, <code>Harbour Seal</code> and <code>Weddell Seal</code>.
<code>myoglobin</code>, a continuous variable, is the response.</p>
</div>
<p>We can use the <code>read_delim()</code> function to import the data and visualise it with <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seal</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"data-raw/seal.txt"</span>, delim <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a rough plot of the data  </span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seal</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">myoglobin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="one-way-anova-revisit_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto auto auto 0;">
Harbour Seals seem to have higher myoglobin than the other two species and the variance in myoglobin for the three species looks about the same.</div>
<p>Let’s create a summary of the data that will be useful for plotting later:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seal_summary</span> <span class="op">&lt;-</span> <span class="va">seal</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">myoglobin</span><span class="op">)</span>,
            std <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">myoglobin</span><span class="op">)</span>,
            n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">myoglobin</span><span class="op">)</span>,
            se <span class="op">=</span> <span class="va">std</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
std
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
se
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Bladdernose Seal
</td>
<td style="text-align:right;">
42.3
</td>
<td style="text-align:right;">
8.02
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.46
</td>
</tr>
<tr>
<td style="text-align:left;">
Harbour Seal
</td>
<td style="text-align:right;">
49.0
</td>
<td style="text-align:right;">
8.25
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.51
</td>
</tr>
<tr>
<td style="text-align:left;">
Weddell Seal
</td>
<td style="text-align:right;">
44.7
</td>
<td style="text-align:right;">
7.85
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.43
</td>
</tr>
</tbody>
</table></div>
<p>Our summary confirms that there are thirty individuals of each species and that highest mean is for Harbour Seals and the lowest is for Bladdernose Seals. The variance within each species is similar.</p>
</div>
<div id="aov-output-reminder" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> <code>aov()</code> output reminder<a class="anchor" aria-label="anchor" href="#aov-output-reminder"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function requires a model formula, <code>myoglobin ~ species</code>, in the familiar format. We also specify the <code>data</code> argument to indicate where the <code>species</code> and <code>myoglobin</code> variables can be found:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">seal</span>, <span class="va">myoglobin</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span></code></pre></div>
<p>The output of the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function gives us an ANOVA test:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co">#             Df Sum Sq Mean Sq F value Pr(&gt;F)   </span>
<span class="co"># species      2    692     346    5.35 0.0064 **</span>
<span class="co"># Residuals   87   5627      65                  </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>There was a significant difference in myoglobin concentration between seal species (ANOVA: <span class="math inline">\(F\)</span> = 5.352; <span class="math inline">\(d.f.\)</span> = 2, 87; <span class="math inline">\(p\)</span> = 0.006). We need a post-hoc multiple comparison test to discover which pairs of means differ significantly.</p>
</div>
<div id="post-hoc-testing-for-aov" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Post-hoc testing for <code>aov()</code><a class="anchor" aria-label="anchor" href="#post-hoc-testing-for-aov"><i class="fas fa-link"></i></a>
</h2>
<p>A commonly applied multiple comparison test applied after an significant ANOVA result is the Tukey Honest Significant Difference test:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co">#   Tukey multiple comparisons of means</span>
<span class="co">#     95% family-wise confidence level</span>
<span class="co"># </span>
<span class="co"># Fit: aov(formula = myoglobin ~ species, data = seal)</span>
<span class="co"># </span>
<span class="co"># $species</span>
<span class="co">#                                diff   lwr    upr p adj</span>
<span class="co"># Harbour Seal-Bladdernose Seal  6.69  1.74 11.646 0.005</span>
<span class="co"># Weddell Seal-Bladdernose Seal  2.34 -2.61  7.296 0.499</span>
<span class="co"># Weddell Seal-Harbour Seal     -4.35 -9.30  0.602 0.097</span></code></pre></div>
<p>The <em>p</em>-value, adjusted for multiple comparisons is given in the <code>p adj</code> column. In this case, only one of the three pairwise comparisons is significant. Harbour Seals, with the highest myoglobin concentrations (<span class="math inline">\(\bar{x} \pm s.e.\)</span>: 49.01 <span class="math inline">\(\pm\)</span> 1.507) ) were significantly higher than Bladdernose Seals with the lowest (<span class="math inline">\(\bar{x} \pm s.e.\)</span>: 42.316 <span class="math inline">\(\pm\)</span> 1.464).</p>
<p>The comparisons being made are known as contrasts and this terminology will appear later.</p>
</div>
<div id="one-way-anovas-as-linear-models" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> One-way ANOVAs as linear models<a class="anchor" aria-label="anchor" href="#one-way-anovas-as-linear-models"><i class="fas fa-link"></i></a>
</h2>
<p>The equation for a one-way ANOVA test is an extension of equation <a href="t-tests-revisit.html#eq:t-test">(5.1)</a> for a <em>t</em>-test. It has the same form but additional parameters. If there are three groups, the model is:</p>
<p><span class="math display" id="eq:one-way">\[\begin{equation}
E(y_{i})=\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}
\tag{6.1}
\end{equation}\]</span></p>
<p>The parameter <span class="math inline">\(\beta_{0}\)</span>, the intercept, is the value of the response when the categorical explanatory is at its “lowest” level. <span class="math inline">\(X1_{i}\)</span> and <span class="math inline">\(X2_{i}\)</span> are the dummy explanatory variables which take a value of 0 or 1 to toggle on and off the effects of <span class="math inline">\(\beta_{1}\)</span> and <span class="math inline">\(\beta_{2}\)</span> respectively.</p>
<p><span class="math inline">\(\beta_{1}\)</span> is the difference between the mean of the group represented by the intercept and the next group and <span class="math inline">\(\beta_{2}\)</span> is the difference between the mean of the group represented by the intercept and the group after that.</p>
<p>An additional parameter and dummy variable are added for each additional group so for four groups the equation is:</p>
<p><span class="math display" id="eq:one-way2">\[\begin{equation}
E(y_{i})=\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}+\beta_{3}X3_{i}
\tag{6.2}
\end{equation}\]</span></p>
<p>A graphical representation of the terms in a linear model when the explanatory variable is categorical with four groups is given in Figure <a href="one-way-anova-revisit.html#fig:one-way-annotated">6.2</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:one-way-annotated"></span>
<img src="images/gen_one_way.svg" alt="A linear model when the explanatory variable is categorical with four groups annotated with the terms used in linear modelling. The measured response values are in pink, the predictions are in green, and the differences between these, known as the residuals, are in blue. The estimated model parameters are indicated: \(\beta_{0}\) is the mean of group A; \(\beta_{1}\) is what has to be added to \(\beta_{0}\) to get the mean of group B; \(\beta_{2}\) is what has to be added to \(\beta_{0}\) to get the mean of group C; and \(\beta_{3}\) is what has to be added to \(\beta_{0}\) to get the mean of group D. In this figure, \(\beta_{1}\) and \(\beta_{2}\) are positive and \(\beta_{3}\) is negative. Compare to Figure 2.2." width="80%"><p class="caption">
Figure 6.2: A linear model when the explanatory variable is categorical with four groups annotated with the terms used in linear modelling. The measured <span style=" font-weight: bold;    color: #d264c0 !important;">response values are in pink</span>, the <span style=" font-weight: bold;    color: #c0d264 !important;">predictions are in green</span>, and the differences between these, known as the <span style=" font-weight: bold;    color: #64c0d2 !important;">residuals, are in blue</span>. The estimated model parameters are indicated: <span class="math inline">\(\beta_{0}\)</span> is the mean of group A; <span class="math inline">\(\beta_{1}\)</span> is what has to be added to <span class="math inline">\(\beta_{0}\)</span> to get the mean of group B; <span class="math inline">\(\beta_{2}\)</span> is what has to be added to <span class="math inline">\(\beta_{0}\)</span> to get the mean of group C; and <span class="math inline">\(\beta_{3}\)</span> is what has to be added to <span class="math inline">\(\beta_{0}\)</span> to get the mean of group D. In this figure, <span class="math inline">\(\beta_{1}\)</span> and <span class="math inline">\(\beta_{2}\)</span> are positive and <span class="math inline">\(\beta_{3}\)</span> is negative. Compare to Figure <a href="what-are-linear-models.html#fig:lm-annotated">2.2</a>.
</p>
</div>
<div class="key">
<p>All the <span class="math inline">\(\beta\)</span> values are given relative to <span class="math inline">\(\beta_{0}\)</span>. Their sign indicates whether a group mean is bigger (positive) or smaller (negative) than the intercept.</p>
</div>
</div>
<div id="applying-and-interpreting-lm-2" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Applying and interpreting <code>lm()</code><a class="anchor" aria-label="anchor" href="#applying-and-interpreting-lm-2"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function is applied to the seal example as follows:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">seal</span>, <span class="va">myoglobin</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span></code></pre></div>
<p>Printing <code>mod</code> to the console gives us the estimated model parameters (coefficients):</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = myoglobin ~ species, data = seal)</span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#         (Intercept)  speciesHarbour Seal  speciesWeddell Seal  </span>
<span class="co">#               42.32                 6.69                 2.34</span></code></pre></div>
The equation for the model is:
<center>
<span class="math inline">\(myoglobin\)</span> = 42.316 + 6.694<span class="math inline">\(speciesHarbour Seal\)</span> + 2.344<span class="math inline">\(speciesWeddell Seal\)</span>
</center>
<p>The first group of <code>seal</code> is <code>Bladdernose Seal</code> so <span class="math inline">\(\beta_{0}\)</span> is the mean of the Bladdernose seals. <span class="math inline">\(\beta_{1}\)</span> is the coefficient labelled <code>speciesHarbour Seal</code> and means when the variable <code>species</code> takes the value <code>Harbour Seal</code>, <span class="math inline">\(\beta_{1}\)</span> must be added to <span class="math inline">\(\beta_{0}\)</span>. The last parameter, <span class="math inline">\(\beta_{2}\)</span>, is the coefficient labelled <code>speciesWeddell Seal</code> and means when the variable <code>species</code> takes the value <code>Weddell Seal</code>, <span class="math inline">\(\beta_{2}\)</span> must be added to <span class="math inline">\(\beta_{0}\)</span>.</p>
<div class="key">
<ul>
<li>Bladdernose mean is <span class="math inline">\(\beta_{0}\)</span>
</li>
<li>Harbour mean is <span class="math inline">\(\beta_{0} + \beta_{1}\)</span>
</li>
<li>Weddell mean is <span class="math inline">\(\beta_{0} + \beta_{2}\)</span>
</li>
</ul>
</div>
<p>The mean myoglobin in Bladdernose seals is 42.316 kg g<sup>-1</sup>, that in Harbour Seals is 42.316 + 6.694 = 49.01 kg g<sup>-1</sup> and in Weddell Seals is 42.316 + 2.344 = 44.66kg g<sup>-1</sup>.</p>
<p>More information including statistical tests of the model and its parameters is obtained by using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = myoglobin ~ species, data = seal)</span>
<span class="co"># </span>
<span class="co"># Residuals:</span>
<span class="co">#     Min      1Q  Median      3Q     Max </span>
<span class="co"># -16.306  -5.578  -0.036   5.240  18.250 </span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#                     Estimate Std. Error t value            Pr(&gt;|t|)    </span>
<span class="co"># (Intercept)            42.32       1.47   28.82 &lt;0.0000000000000002 ***</span>
<span class="co"># speciesHarbour Seal     6.69       2.08    3.22              0.0018 ** </span>
<span class="co"># speciesWeddell Seal     2.34       2.08    1.13              0.2620    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># Residual standard error: 8.04 on 87 degrees of freedom</span>
<span class="co"># Multiple R-squared:  0.11,    Adjusted R-squared:  0.0891 </span>
<span class="co"># F-statistic: 5.35 on 2 and 87 DF,  p-value: 0.00643</span></code></pre></div>
<p>The <code>Coefficients</code> table gives the estimated <span class="math inline">\(\beta_{0}\)</span>, <span class="math inline">\(\beta_{1}\)</span> and <span class="math inline">\(\beta_{2}\)</span> again but along with their standard errors and tests of whether the estimates differ from zero. The estimated mean of the Bladdernose seals is 42.316 <span class="math inline">\(\pm\)</span> 1.468 kg g<sup>1</sup> and this differs significantly from zero (<span class="math inline">\(p\)</span> &lt; 0.001). The estimated difference between the Bladdernose and Harbour seals is 6.694 <span class="math inline">\(\pm\)</span> 2.077 and also differs significantly from zero (<span class="math inline">\(p\)</span> = 0.002). The estimated difference between the Bladdernose and Weddell seals, 2.344 <span class="math inline">\(\pm\)</span> 2.077 kg g<sup>1</sup>, does not differ significantly from zero (<span class="math inline">\(p\)</span> = 0.262). The fact that both parameters are positive tells us both of the other two species have higher means than Bladdernose.</p>
<p>The proportion of the variance in the omega which is explained by the model is 0.11 and this is a significant proportion of that variance (<span class="math inline">\(p\)</span> = 0.006).</p>
<p>This is the first time we have a model where the <em>p</em>-value for the model and the <em>p</em>-values for the <span class="math inline">\(\beta\)</span> parameters differ. This is because we are fitting two parameters after the intercept.</p>
<p>Replacing the terms shown in Figure <a href="one-way-anova-revisit.html#fig:one-way-annotated">6.2</a> with the values in this example gives us <a href="one-way-anova-revisit.html#fig:seal-annotated">6.3</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:seal-annotated"></span>
<img src="images/seal_lm_eg.svg" alt="The annotated model with the values from the Seal species example. The measured response values are in pink, the predictions are in green, and the residuals, are in blue. One example of a measured value, a predicted value and the residual is shown for an individual harbour seal. The estimated model parameters are indicated: \(\beta_{0}\), the mean of the Bladdernose Seals, is 42.316 kg g1; \(\beta_{1}\) is 6.694 thus the mean of Harbour Seals 42.316 + 6.694 = 49.01 kg g^-1; and \(\beta_{2}\) is 2.344 thus the mean of Weddell Seals 42.316 + 2.344 = 49.01 kg g^-1. Compare to Figure 6.2." width="80%"><p class="caption">
Figure 6.3: The annotated model with the values from the Seal species example. The measured <span style=" font-weight: bold;    color: #d264c0 !important;">response values are in pink</span>, the <span style=" font-weight: bold;    color: #c0d264 !important;">predictions are in green</span>, and the <span style=" font-weight: bold;    color: #64c0d2 !important;">residuals, are in blue</span>. One example of a measured value, a predicted value and the residual is shown for an individual harbour seal. The estimated model parameters are indicated: <span class="math inline">\(\beta_{0}\)</span>, the mean of the Bladdernose Seals, is 42.316 kg g<sup>1</sup>; <span class="math inline">\(\beta_{1}\)</span> is 6.694 thus the mean of Harbour Seals 42.316 + 6.694 = 49.01 kg g^-1; and <span class="math inline">\(\beta_{2}\)</span> is 2.344 thus the mean of Weddell Seals 42.316 + 2.344 = 49.01 kg g^-1. Compare to Figure <a href="one-way-anova-revisit.html#fig:one-way-annotated">6.2</a>.
</p>
</div>
</div>
<div id="getting-predictions-from-the-model-2" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Getting predictions from the model<a class="anchor" aria-label="anchor" href="#getting-predictions-from-the-model-2"><i class="fas fa-link"></i></a>
</h2>
<p>We already have the predictions for all possible values of the explanatory variable because it is categorical.</p>
<p>However, the code for using predict is included here, as it was in the last chapter, because it will make it easier to understand more complex examples later. We need to create a dataframe of values for which we want predictions and pass it as an argument to the predict() function.</p>
<p>To create a dataframe with one column of Species values:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bladdernose Seal"</span>,
                                      <span class="st">"Harbour Seal"</span>,
                                      <span class="st">"Weddell Seal"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="key">
<p>Remember! The variable and its values have to exactly match those in the model.</p>
</div>
<p>The to get the predicted myoglobin content for the three species:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="va">predict_for</span><span class="op">)</span></code></pre></div>
</div>
<div id="checking-assumptions-3" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> Checking assumptions<a class="anchor" aria-label="anchor" href="#checking-assumptions-3"><i class="fas fa-link"></i></a>
</h2>
<p>The two assumptions of the model can be checked using diagnostic plots. The Q-Q plot is obtained with:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="one-way-anova-revisit_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto auto auto 0;">
The residual seem to be normally distributed.</div>
<p>Let’s look at the Residuals vs Fitted plot:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="one-way-anova-revisit_files/figure-html/unnamed-chunk-17-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
<p>The residuals are equally spread around a horizontal line; the assumptions seem to be met.</p>
</div>
<div id="post-hoc-testing-for-lm" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> Post-hoc testing for <code>lm()</code><a class="anchor" aria-label="anchor" href="#post-hoc-testing-for-lm"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> requires output from the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> so we will use the <code><a href="https://rdrr.io/pkg/lsmeans/man/ref.grid.html">lsmeans()</a></code> (<strong>L</strong>east-<strong>S</strong>quares <strong>means</strong>) function from the <strong><code>lsmeans</code></strong> package <span class="citation">(<a href="references.html#ref-lsmeans" role="doc-biblioref">Lenth 2016</a>)</span> with <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code> from the <strong><code>multcompView</code></strong> package. These two functions can be applied to <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> and <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> outputs.</p>
<p>Load the packages:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lsmeans</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">multcompView</span><span class="op">)</span></code></pre></div>
<p>And run the post-hoc test:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lsmeans/man/ref.grid.html">lsmeans</a></span><span class="op">(</span><span class="va">mod</span>, <span class="op">~</span> <span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#  contrast                        estimate   SE df t.ratio p.value</span>
<span class="co">#  Bladdernose Seal - Harbour Seal    -6.69 2.08 87  -3.220  0.0050</span>
<span class="co">#  Bladdernose Seal - Weddell Seal    -2.34 2.08 87  -1.130  0.4990</span>
<span class="co">#  Harbour Seal - Weddell Seal         4.35 2.08 87   2.090  0.0970</span>
<span class="co"># </span>
<span class="co"># P value adjustment: tukey method for comparing a family of 3 estimates</span></code></pre></div>
<p>The correction for the multiple testing uses the Tukey method (just like <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code>).</p>
<p>The results are the same as for using <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> as we have done the same tests using a different function.</p>
</div>
<div id="creating-a-figure-2" class="section level2" number="6.9">
<h2>
<span class="header-section-number">6.9</span> Creating a figure<a class="anchor" aria-label="anchor" href="#creating-a-figure-2"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_jitter</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seal</span>, 
              <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">myoglobin</span><span class="op">)</span>, 
              width <span class="op">=</span> <span class="fl">0.25</span>, colour <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seal_summary</span>,
                <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>,
                    ymin <span class="op">=</span> <span class="va">mean</span>,
                    ymax <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,
                width <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seal_summary</span>,
                <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>,
                    ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="va">se</span>,
                    ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="va">se</span><span class="op">)</span>,
                width <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">71</span>, xend <span class="op">=</span> <span class="fl">2</span>, yend <span class="op">=</span> <span class="fl">71</span><span class="op">)</span>,
               size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">71</span>, xend <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">69</span><span class="op">)</span>,
               size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">71</span>, xend <span class="op">=</span> <span class="fl">2</span>, yend <span class="op">=</span> <span class="fl">69</span><span class="op">)</span>,
               size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fl">73</span>,  label <span class="op">=</span> <span class="st">"**"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Myoglobin concentration g "</span><span class="op">*</span><span class="va">Kg</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span>,
                     expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">75</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="one-way-anova-revisit_files/figure-html/fig-one-anova-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
</div>
<div id="reporting-the-results-2" class="section level2" number="6.10">
<h2>
<span class="header-section-number">6.10</span> Reporting the results<a class="anchor" aria-label="anchor" href="#reporting-the-results-2"><i class="fas fa-link"></i></a>
</h2>
<p>There is a significant difference in myoglobin concentration between Seal species (ANOVA: <span class="math inline">\(F\)</span> = 5.352; <span class="math inline">\(d.f.\)</span> = 2, 87; <span class="math inline">\(p\)</span> = 0.006). Post-hoc testing revealed that difference to be between the Harbour Seal with the highest myoglobin concentrations (<span class="math inline">\(\bar{x} \pm s.e.\)</span>: 49.01 <span class="math inline">\(\pm\)</span> 1.507) ) and the Bladdernose Seal (<span class="math inline">\(p\)</span> = 0.005) with the lowest (<span class="math inline">\(\bar{x} \pm s.e.\)</span>: 42.316 <span class="math inline">\(\pm\)</span> 1.464). See figure <a href="one-way-anova-revisit.html#fig:fig-one-anova-report">6.4</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:fig-one-anova-report"></span>
<img src="one-way-anova-revisit_files/figure-html/fig-one-anova-report-1.png" alt="Muscle myoglobin content of three seal species. Error bars are \(\pm 1 S.E.\). ** significant difference at the \(p &lt; 0.001\) level." width="60%"><p class="caption">
Figure 6.4: Muscle myoglobin content of three seal species. Error bars are <span class="math inline">\(\pm 1 S.E.\)</span>. ** significant difference at the <span class="math inline">\(p &lt; 0.001\)</span> level.
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="t-tests-revisit.html"><span class="header-section-number">5</span> t-tests revisited</a></div>
<div class="next"><a href="two-way-anova-revisit.html"><span class="header-section-number">7</span> Two-way ANOVA revisited</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#one-way-anova-revisit"><span class="header-section-number">6</span> One-way ANOVA revisited</a></li>
<li><a class="nav-link" href="#introduction-to-the-example-2"><span class="header-section-number">6.1</span> Introduction to the example</a></li>
<li><a class="nav-link" href="#aov-output-reminder"><span class="header-section-number">6.2</span> aov() output reminder</a></li>
<li><a class="nav-link" href="#post-hoc-testing-for-aov"><span class="header-section-number">6.3</span> Post-hoc testing for aov()</a></li>
<li><a class="nav-link" href="#one-way-anovas-as-linear-models"><span class="header-section-number">6.4</span> One-way ANOVAs as linear models</a></li>
<li><a class="nav-link" href="#applying-and-interpreting-lm-2"><span class="header-section-number">6.5</span> Applying and interpreting lm()</a></li>
<li><a class="nav-link" href="#getting-predictions-from-the-model-2"><span class="header-section-number">6.6</span> Getting predictions from the model</a></li>
<li><a class="nav-link" href="#checking-assumptions-3"><span class="header-section-number">6.7</span> Checking assumptions</a></li>
<li><a class="nav-link" href="#post-hoc-testing-for-lm"><span class="header-section-number">6.8</span> Post-hoc testing for lm()</a></li>
<li><a class="nav-link" href="#creating-a-figure-2"><span class="header-section-number">6.9</span> Creating a figure</a></li>
<li><a class="nav-link" href="#reporting-the-results-2"><span class="header-section-number">6.10</span> Reporting the results</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/3mmaRand/gist-lm/blob/master/one-way-anova-revisit.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/3mmaRand/gist-lm/edit/master/one-way-anova-revisit.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</strong>" was written by Emma Rand. It was last built on September 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
