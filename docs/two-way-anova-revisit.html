<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Two-way ANOVA revisited | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</title>
<meta name="author" content="Emma Rand">
<meta name="description" content="In this chapter we turn our attention to designs with two categorical explanatory variables. We will use the same approach that we used in the previous two chapters: first using the familiar aov()...">
<meta name="generator" content="bookdown 0.24.1 with bs4_book()">
<meta property="og:title" content="Chapter 7 Two-way ANOVA revisited | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users">
<meta property="og:type" content="book">
<meta property="og:url" content="https://3mmarand.github.io/gist-lm/two-way-anova-revisit.html">
<meta property="og:image" content="https://3mmarand.github.io/gist-lm/images/hex-s.png">
<meta property="og:description" content="In this chapter we turn our attention to designs with two categorical explanatory variables. We will use the same approach that we used in the previous two chapters: first using the familiar aov()...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Two-way ANOVA revisited | gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users">
<meta name="twitter:description" content="In this chapter we turn our attention to designs with two categorical explanatory variables. We will use the same approach that we used in the previous two chapters: first using the familiar aov()...">
<meta name="twitter:image" content="https://3mmarand.github.io/gist-lm/images/hex-s.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0.9000/transition.js"></script><script src="libs/bs3compat-0.3.0.9000/tabs.js"></script><script src="libs/bs3compat-0.3.0.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="assets/book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">INTRODUCTION</li>
<li><a class="" href="revision.html"><span class="header-section-number">1</span> Revision of your Introductory class</a></li>
<li><a class="" href="what-are-linear-models.html"><span class="header-section-number">2</span> What are General Linear Models</a></li>
<li><a class="" href="terminolgy.html"><span class="header-section-number">3</span> Terminolgy</a></li>
<li class="book-part">USING lm() FOR FAMILIAR TESTS</li>
<li><a class="" href="single-regression.html"><span class="header-section-number">4</span> Single linear regression</a></li>
<li><a class="" href="t-tests-revisit.html"><span class="header-section-number">5</span> t-tests revisited</a></li>
<li><a class="" href="one-way-anova-revisit.html"><span class="header-section-number">6</span> One-way ANOVA revisited</a></li>
<li><a class="active" href="two-way-anova-revisit.html"><span class="header-section-number">7</span> Two-way ANOVA revisited</a></li>
<li><a class="" href="summary.html"><span class="header-section-number">8</span> Summary</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="two-way-anova-revisit" class="section level1">
<h1>
<span class="header-section-number">7</span> Two-way ANOVA revisited<a class="anchor" aria-label="anchor" href="#two-way-anova-revisit"><i class="fas fa-link"></i></a>
</h1>
<p>In this chapter we turn our attention to designs with two categorical explanatory variables. We will use the same approach that we used in the previous two chapters: first using the familiar <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function to carry out a two-way ANOVA and then the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function. We will also make predictions from the model and report on our results.</p>
<div id="introduction-to-the-example-3" class="section level2">
<h2>
<span class="header-section-number">7.1</span> Introduction to the example<a class="anchor" aria-label="anchor" href="#introduction-to-the-example-3"><i class="fas fa-link"></i></a>
</h2>
<p>Researchers have collected live specimens of two species of periwinkle (see Figure <a href="two-way-anova-revisit.html#fig:periwinkle-fig">7.1</a>) from sites in northern England in the Spring and Summer. They take a measure of the gut parasite load by examining a slide of gut contents. The data are in <a href="data-raw/periwinkle.txt">periwinkle.txt</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:periwinkle-fig"></span>
<img src="images/Littorina.jpg" alt="Periwinkles are marine gastropod molluscs (slugs and snails). A) Littorina brevicula (PD files - Public Domain, https://commons.wikimedia.org/w/index.php?curid=30577419) B) Littorina littorea. (photographed by Guttorm Flatabø (user:dittaeva). - Photograph taken with an Olympus Camedia C-70 Zoom digital camera. Metainformation edited with Irfanview, possibly cropped with jpegcrop., CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=324769" width="80%"><p class="caption">
Figure 7.1: Periwinkles are marine gastropod molluscs (slugs and snails). A) <em>Littorina brevicula</em> (PD files - Public Domain, <a href="https://commons.wikimedia.org/w/index.php?curid=30577419" class="uri">https://commons.wikimedia.org/w/index.php?curid=30577419</a>) B) <em>Littorina littorea</em>. (photographed by Guttorm Flatabø (user:dittaeva). - Photograph taken with an Olympus Camedia C-70 Zoom digital camera. Metainformation edited with Irfanview, possibly cropped with jpegcrop., CC BY-SA 3.0, <a href="https://commons.wikimedia.org/w/index.php?curid=324769" class="uri">https://commons.wikimedia.org/w/index.php?curid=324769</a>
</p>
</div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
para
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
season
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
species
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
72
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
84
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
88
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
81
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
88
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
73
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
74
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
89
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
74
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
79
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
86
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
97
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
81
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
85
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
59
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
</tr>
</tbody>
</table></div>
</div>
<p>The data were collected to determine whether there was an effect of season or species on parasite load and whether these effects were independent.</p>
<div class="key">
<p>There are 3 variables: <code>species</code> and <code>season</code>are categorical explanatory variables, each with two levels;
<code>para</code>, a continuous variable, is the response.</p>
</div>
<p>We can use the <code>read_delim()</code> function to import the data.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">periwinkle</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"data-raw/periwinkle.txt"</span>, delim <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></code></pre></div>
<p>When visualising this data with <code>ggplot()</code> we need to account for both explanatory variables. We can map one to the <em>x</em>-axis and the other to a different aesthetic. Using the <code>fill</code> aesthetic works well for violin plots.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">periwinkle</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">season</span>, y <span class="op">=</span> <span class="va">para</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="two-way-anova-revisit_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto auto auto 0;">
Parasite load seems to be higher for both species in the summer and that effect looks bigger in <em>L.brevicula</em> - it has the lowest spring mean but the highest summer mean.</p>
<p>Let’s create a summary of the data that will be useful for plotting later:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peri_summary</span> <span class="op">&lt;-</span> <span class="va">periwinkle</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">season</span>, <span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">para</span><span class="op">)</span>,
            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">para</span><span class="op">)</span>,
            n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">para</span><span class="op">)</span>,
            se <span class="op">=</span> <span class="va">sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
season
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
se
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:right;">
56.5
</td>
<td style="text-align:right;">
8.88
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:right;">
63.8
</td>
<td style="text-align:right;">
11.92
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
2.38
</td>
</tr>
<tr>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:right;">
72.9
</td>
<td style="text-align:right;">
11.24
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
2.25
</td>
</tr>
<tr>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:right;">
69.4
</td>
<td style="text-align:right;">
11.44
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
2.29
</td>
</tr>
</tbody>
</table></div>
<p>The summary confirms both species have a higher mean in the summer and that the difference between the species is reversed - <em>L.brevicula</em> <span class="math inline">\(-\)</span> <em>L.littorea</em> is -7.28 in the spring but 3.48 in summer.</p>
</div>
<div id="aov-output-reminder-1" class="section level2">
<h2>
<span class="header-section-number">7.2</span> <code>aov()</code> output reminder<a class="anchor" aria-label="anchor" href="#aov-output-reminder-1"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function requires a model formula which includes both explanatory variables and the interaction between them in the familiar format: <code>para ~ season * season</code> . We also specify the data argument to indicate where the variables can be found:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">periwinkle</span>, <span class="va">para</span> <span class="op">~</span> <span class="va">season</span> <span class="op">*</span> <span class="va">species</span><span class="op">)</span></code></pre></div>
<p>The output of the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function gives us an ANOVA test:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co">#                Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class="co"># season          1   3058    3058   25.58  2e-06 ***</span>
<span class="co"># species         1     90      90    0.75  0.387    </span>
<span class="co"># season:species  1    724     724    6.05  0.016 *  </span>
<span class="co"># Residuals      96  11477     120                   </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>There was a significantly greater number of parasites in the Summer than the Spring (ANOVA: <span class="math inline">\(F\)</span> = 25.58; <span class="math inline">\(d.f.\)</span> = 1, 96; <span class="math inline">\(p\)</span> &lt; 0.001). There was no difference between the species when averaged across the seasons but there was significant interaction (ANOVA: <span class="math inline">\(F\)</span> = 6.053; <span class="math inline">\(d.f.\)</span> = 1, 96; <span class="math inline">\(p\)</span> = 0.016) between season and species with higher numbers infecting <em>L.littorea</em> in the Spring whilst <em>L.brevicula</em> was more heavily parasitized in the Summer.</p>
<p>We need a post-hoc test to discover which comparisons are significant.</p>
</div>
<div id="post-hoc-testing-for-aov-1" class="section level2">
<h2>
<span class="header-section-number">7.3</span> Post-hoc testing for <code>aov</code><a class="anchor" aria-label="anchor" href="#post-hoc-testing-for-aov-1"><i class="fas fa-link"></i></a>
</h2>
<p>Tukey Honest Significant Difference test is carried out with:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co">#   Tukey multiple comparisons of means</span>
<span class="co">#     95% family-wise confidence level</span>
<span class="co"># </span>
<span class="co"># Fit: aov(formula = para ~ season * species, data = periwinkle)</span>
<span class="co"># </span>
<span class="co"># $season</span>
<span class="co">#               diff  lwr  upr p adj</span>
<span class="co"># Summer-Spring 11.1 6.72 15.4     0</span>
<span class="co"># </span>
<span class="co"># $species</span>
<span class="co">#                                        diff   lwr  upr p adj</span>
<span class="co"># Littorina littorea-Littorina brevicula  1.9 -2.44 6.24 0.387</span>
<span class="co"># </span>
<span class="co"># $`season:species`</span>
<span class="co">#                                                        diff     lwr   upr p adj</span>
<span class="co"># Summer:Littorina brevicula-Spring:Littorina brevicula 16.44   8.354 24.53 0.000</span>
<span class="co"># Spring:Littorina littorea-Spring:Littorina brevicula   7.28  -0.806 15.37 0.093</span>
<span class="co"># Summer:Littorina littorea-Spring:Littorina brevicula  12.96   4.874 21.05 0.000</span>
<span class="co"># Spring:Littorina littorea-Summer:Littorina brevicula  -9.16 -17.246 -1.07 0.020</span>
<span class="co"># Summer:Littorina littorea-Summer:Littorina brevicula  -3.48 -11.566  4.61 0.675</span>
<span class="co"># Summer:Littorina littorea-Spring:Littorina littorea    5.68  -2.406 13.77 0.263</span></code></pre></div>
<p>The parasite load for <em>L.brevicula</em> increases significantly between spring and summer (<span class="math inline">\(p\)</span> &lt; 0.001) while that for <em>L.littorea</em> does not. Other significant comparisons are: the spring load of <em>L.brevicula</em> is lower than the summer load of <em>L.littorea</em> (<span class="math inline">\(p\)</span> &lt; 0.001); and summer load of <em>L.brevicula</em> is higher than the spring load of <em>L.littorea</em> (<span class="math inline">\(p\)</span> = 0.02).</p>
</div>
<div id="two-way-anovas-as-linear-models" class="section level2">
<h2>
<span class="header-section-number">7.4</span> Two-way ANOVAs as linear models<a class="anchor" aria-label="anchor" href="#two-way-anovas-as-linear-models"><i class="fas fa-link"></i></a>
</h2>
<p>The equation for a two-way ANOVA test is an extension of equation <a href="one-way-anova-revisit.html#eq:one-way">(6.1)</a> for a one-way ANOVA test. It has the same form but an additional parameter. If there are two groups in each explanatory variable, the model is:</p>
<p><span class="math display" id="eq:one-way">\[\begin{equation}
E(y_{i})=\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}+\beta_{3}X1_{i}X2_{i}
\tag{6.1}
\end{equation}\]</span></p>
<p>The intercept, <span class="math inline">\(\beta_{0}\)</span> is the value of the response when both categorical explanatory variables are at their “lowest” level. <span class="math inline">\(X1_{i}\)</span> is a dummy explanatory variable which indicates the first explanatory variable changing to its second level. It toggles on and off the effects of <span class="math inline">\(\beta_{1}\)</span>. <span class="math inline">\(X2_{i}\)</span> is a dummy explanatory variable which indicates the second explanatory variable changing to its second level and toggles on and off the effects of <span class="math inline">\(\beta_{2}\)</span>. <span class="math inline">\(\beta_{3}\)</span> is the interaction effect. If <span class="math inline">\(X1_{i}\)</span> and <span class="math inline">\(X2_{i}\)</span> are both 1 <span class="math inline">\(\beta_{3}\)</span> is the extra effect of that combination above the sum of
<span class="math inline">\(\beta_{1}+\beta_{2}\)</span></p>
<p>The number of parameters in a two-way ANOVA design is: the number of levels in one explanatory <span class="math inline">\(\times\)</span> the number of levels in the other explanatory. If each explanatory have three levels, there would be nine <span class="math inline">\(\beta s\)</span></p>
<p>A graphical representation of the terms in a linear model when there are two explanatory variables each with two groups (or levels) is given in Figure <a href="two-way-anova-revisit.html#fig:two-way-annotated">7.2</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:two-way-annotated"></span>
<img src="images/gen_two_way.svg" alt="A linear model with two explanatory variables each with two levels. ‘Variable 1’ has levels ‘A’ and ‘B’ and ‘Variable 2’ has levels ‘a’ and ‘b’. Thus there are 2 \(\times\) 2 = 4 groups: Aa, Ab, Ba and Bb. The measured response values are in pink and the predictions are in green. The residuals are not indicated. The estimated model parameters are indicated: \(\beta_{0}\) is the mean of group Aa; \(\beta_{1}\) is what has to be added to \(\beta_{0}\) to get the mean of group Ab; \(\beta_{2}\) is what has to be added to \(\beta_{0}\) to get the mean of group Ba; and \(\beta_{3}\) is what has to be added to \(\beta_{0}\) in addition to \(\beta_{1}\) and \(\beta_{2}\) to get the mean of group Bb. In this figure, all parameters are positive. Compare to Figure 2.2." width="80%"><p class="caption">
Figure 7.2: A linear model with two explanatory variables each with two levels. ‘Variable 1’ has levels ‘A’ and ‘B’ and ‘Variable 2’ has levels ‘a’ and ‘b’. Thus there are 2 <span class="math inline">\(\times\)</span> 2 = 4 groups: Aa, Ab, Ba and Bb. The measured <span style=" font-weight: bold;    color: #d264c0 !important;">response values are in pink</span> and the <span style=" font-weight: bold;    color: #c0d264 !important;">predictions are in green</span>. The residuals are not indicated. The estimated model parameters are indicated: <span class="math inline">\(\beta_{0}\)</span> is the mean of group Aa; <span class="math inline">\(\beta_{1}\)</span> is what has to be added to <span class="math inline">\(\beta_{0}\)</span> to get the mean of group Ab; <span class="math inline">\(\beta_{2}\)</span> is what has to be added to <span class="math inline">\(\beta_{0}\)</span> to get the mean of group Ba; and <span class="math inline">\(\beta_{3}\)</span> is what has to be added to <span class="math inline">\(\beta_{0}\)</span> in addition to <span class="math inline">\(\beta_{1}\)</span> and <span class="math inline">\(\beta_{2}\)</span> to get the mean of group Bb. In this figure, all parameters are positive. Compare to Figure <a href="what-are-linear-models.html#fig:lm-annotated">2.2</a>.
</p>
</div>
<div class="key">
<p>The intercept, <span class="math inline">\(\beta_{0}\)</span>is the response when both explanatory variable is at their first group and all the other <span class="math inline">\(\beta s\)</span> are given relative to this.</p>
</div>
<div class="key">
<p>The interaction parameters give the effect of the combination in addition to the sum of their independent effects</p>
</div>
</div>
<div id="applying-and-interpreting-lm-3" class="section level2">
<h2>
<span class="header-section-number">7.5</span> Applying and interpreting <code>lm()</code><a class="anchor" aria-label="anchor" href="#applying-and-interpreting-lm-3"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function is applied to the periwinkle example as follows:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">periwinkle</span>, <span class="va">para</span> <span class="op">~</span> <span class="va">season</span> <span class="op">*</span> <span class="va">species</span><span class="op">)</span></code></pre></div>
<p>Printing <code>mod</code> to the console gives us the estimated model parameters (coefficients):</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = para ~ season * species, data = periwinkle)</span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#                            (Intercept)                            seasonSummer  </span>
<span class="co">#                                  56.48                                   16.44  </span>
<span class="co">#              speciesLittorina littorea  seasonSummer:speciesLittorina littorea  </span>
<span class="co">#                                   7.28                                  -10.76</span></code></pre></div>
The equation for the model is:
<center>
<span class="math inline">\(para\)</span> = 56.48 + 16.44<span class="math inline">\(speciesLittorina littorea\)</span> + 7.28<span class="math inline">\(seasonSummer:speciesLittorina littorea\)</span>
</center>
<p>The first group of <code>season</code> is <code>Spring</code> and the first group of <code>species</code> is <code>Littorina brevicula</code>so <span class="math inline">\(\beta_{0}\)</span> is the mean of <em>L.brevicula</em> in the spring, 56.48.</p>
<p><span class="math inline">\(\beta_{1}\)</span> is the coefficient labelled <code>seasonSummer</code> and means when the variable <code>season</code> takes the value <code>Summer</code>, <span class="math inline">\(\beta_{1}\)</span> must be added to <span class="math inline">\(\beta_{0}\)</span> - the mean of <em>L.brevicula</em> in the summer is <span class="math inline">\(\beta_{0}+\beta_{1}\)</span> = 56.48 <span class="math inline">\(+\)</span> 16.44 <span class="math inline">\(=\)</span> 72.92.<br>
The coefficient labelled <code>speciesLittorina littorea</code> is <span class="math inline">\(\beta_{2}\)</span>. When species becomes <code>Littorina littorea</code>, <span class="math inline">\(\beta_{1}\)</span> must be added to <span class="math inline">\(\beta_{0}\)</span> thus the mean of <em>L.littorea</em> in spring is <span class="math inline">\(\beta_{0}+\beta_{2}\)</span> = 56.48 <span class="math inline">\(+\)</span> 7.28 <span class="math inline">\(=\)</span> 63.76.</p>
<p>If both <code>season</code> becomes <code>Summer</code> and species becomes <code>Littorina littorea</code> you would expect the effect to be <span class="math inline">\(\beta_{0}+\beta_{1}+\beta_{2}\)</span>. The coefficient labelled <code>seasonSummer:speciesLittorina littorea</code>, <span class="math inline">\(\beta_{3}\)</span> is the effect that is <em>additional</em> to that sum. An interaction occurs when the combined effect of two variables differs from just adding the independent effects. The mean of <em>L.littorea</em> in summer is <span class="math inline">\(\beta_{0}+\beta_{1}+\beta_{2}+\beta_{3}\)</span> = 56.48 <span class="math inline">\(+\)</span> 16.44 <span class="math inline">\(+\)</span> 7.28 <span class="math inline">\(+\)</span> -10.76 <span class="math inline">\(=\)</span> 69.44.</p>
<p>More information including statistical tests of the model and its parameters is obtained by using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = para ~ season * species, data = periwinkle)</span>
<span class="co"># </span>
<span class="co"># Residuals:</span>
<span class="co">#    Min     1Q Median     3Q    Max </span>
<span class="co"># -20.76  -6.13  -1.10   8.12  28.08 </span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#                                        Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co"># (Intercept)                               56.48       2.19   25.83  &lt; 2e-16 ***</span>
<span class="co"># seasonSummer                              16.44       3.09    5.32  6.9e-07 ***</span>
<span class="co"># speciesLittorina littorea                  7.28       3.09    2.35    0.021 *  </span>
<span class="co"># seasonSummer:speciesLittorina littorea   -10.76       4.37   -2.46    0.016 *  </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># Residual standard error: 10.9 on 96 degrees of freedom</span>
<span class="co"># Multiple R-squared:  0.252,   Adjusted R-squared:  0.229 </span>
<span class="co"># F-statistic: 10.8 on 3 and 96 DF,  p-value: 3.55e-06</span></code></pre></div>
<p>The <code>Coefficients</code> table gives the estimated <span class="math inline">\(\beta_{0}\)</span>, <span class="math inline">\(\beta_{1}\)</span>, <span class="math inline">\(\beta_{2}\)</span> and <span class="math inline">\(\beta_{3}\)</span> again but along with their standard errors and tests of whether the estimates differ from zero.</p>
<p>The estimated mean of <em>L.brevicula</em> in the spring is 56.48 <span class="math inline">\(\pm\)</span> 2.187 and this differs significantly from zero (<span class="math inline">\(p\)</span> &lt; 0.001). The estimated difference between <em>L.brevicula</em> in the spring and <em>L.brevicula</em> in the summer is 16.44 <span class="math inline">\(\pm\)</span> 3.093 and also differs significantly from zero (<span class="math inline">\(p\)</span> &lt; 0.001).</p>
<p>The estimated difference between <em>L.brevicula</em> in the spring and <em>L.littorea</em> in the spring, 7.28 <span class="math inline">\(\pm\)</span> 3.093 differs significantly from zero (<span class="math inline">\(p\)</span> = 0.021).</p>
<p>The proportion of the variance in parasite load explained by the model is 0.252 and this is a significant proportion of that variance (<span class="math inline">\(p\)</span> &lt; 0.001).</p>
<p>We are fitting three parameters in addition to the intercept which means the <em>p</em>-value for the model, and the <em>p</em>-values for the <span class="math inline">\(\beta\)</span> parameters, differ. This was also true for <a href="one-way-anova-revisit.html#one-way-anova-revisit">one-way ANOVA</a>.</p>
<p>Replacing the terms shown in Figure <a href="two-way-anova-revisit.html#fig:two-way-annotated">7.2</a> with the values in this example gives us <a href="two-way-anova-revisit.html#fig:periwinkle-annotated">7.3</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:periwinkle-annotated"></span>
<img src="images/peri_lm_eg.svg" alt="The annotated model with the values from the parasite load of preiwinkle example. The measured response values are in pink and the predictions are in green. The estimated model parameters are indicated: \(\beta_{0}\), the mean of L.brevicula in the spring, is 56.48; \(\beta_{1}\) is 16.44 thus the mean of L.brevicula in the summer 56.48 + 16.44 = 72.92; \(\beta_{2}\) is 7.28 thus the mean of L.littorea in the spring 56.48 + 7.28 = 72.92; and the L.littorea in the summer is \(\beta_{0}+\beta_{1}+\beta_{2}+\beta_{3}\) = 56.48 \(+\) 16.44 \(+\) 7.28 \(+\) -10.76 \(=\) 69.44. Compare to Figure 7.2." width="80%"><p class="caption">
Figure 7.3: The annotated model with the values from the parasite load of preiwinkle example. The measured <span style=" font-weight: bold;    color: #d264c0 !important;">response values are in pink</span> and the <span style=" font-weight: bold;    color: #c0d264 !important;">predictions are in green</span>. The estimated model parameters are indicated: <span class="math inline">\(\beta_{0}\)</span>, the mean of <em>L.brevicula</em> in the spring, is 56.48; <span class="math inline">\(\beta_{1}\)</span> is 16.44 thus the mean of <em>L.brevicula</em> in the summer 56.48 + 16.44 = 72.92; <span class="math inline">\(\beta_{2}\)</span> is 7.28 thus the mean of <em>L.littorea</em> in the spring 56.48 + 7.28 = 72.92; and the <em>L.littorea</em> in the summer is <span class="math inline">\(\beta_{0}+\beta_{1}+\beta_{2}+\beta_{3}\)</span> = 56.48 <span class="math inline">\(+\)</span> 16.44 <span class="math inline">\(+\)</span> 7.28 <span class="math inline">\(+\)</span> -10.76 <span class="math inline">\(=\)</span> 69.44. Compare to Figure <a href="two-way-anova-revisit.html#fig:two-way-annotated">7.2</a>.
</p>
</div>
</div>
<div id="getting-predictions-from-the-model-3" class="section level2">
<h2>
<span class="header-section-number">7.6</span> Getting predictions from the model<a class="anchor" aria-label="anchor" href="#getting-predictions-from-the-model-3"><i class="fas fa-link"></i></a>
</h2>
<p>We already have the predictions for all possible combinations of values of the explanatory variables because both are categorical.</p>
<p>However, the code for using predict is included here, as it was in the previous two chapters chapter, because it will make it easier to understand more complex examples later. We need to create a dataframe of values for which we want predictions and pass it as an argument to the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function.</p>
<p>To create a dataframe with one column of <code>species</code> values and one column of <code>season</code> values:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Littorina brevicula"</span>, <span class="st">"Littorina littorea"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
                          season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Spring"</span>, <span class="st">"Summer"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="key">
<p>Remember! The variable and its values have to exactly match those in the model.</p>
</div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
species
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
season
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring
</td>
</tr>
<tr>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer
</td>
</tr>
<tr>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring
</td>
</tr>
<tr>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer
</td>
</tr>
</tbody>
</table></div>
</div>
<p>Then, to get the predicted parasite load for each of the four groups:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="va">predict_for</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
species
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
season
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:right;">
56.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:right;">
72.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:right;">
63.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:right;">
69.4
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="checking-assumptions-4" class="section level2">
<h2>
<span class="header-section-number">7.7</span> Checking assumptions<a class="anchor" aria-label="anchor" href="#checking-assumptions-4"><i class="fas fa-link"></i></a>
</h2>
<p>The two assumptions of the model can be checked using diagnostic plots. The Q-Q plot is obtained with:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="two-way-anova-revisit_files/figure-html/unnamed-chunk-19-1.png" width="80%" style="display: block; margin: auto auto auto 0;">
The residual seem to be normally distributed.</div>
<p>Let’s look at the Residuals vs Fitted plot:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="two-way-anova-revisit_files/figure-html/unnamed-chunk-20-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
<p>The residuals are equally spread around a horizontal line; the assumptions seem to be met.</p>
</div>
<div id="post-hoc-testing-for-lm-1" class="section level2">
<h2>
<span class="header-section-number">7.8</span> Post-hoc testing for <code>lm()</code><a class="anchor" aria-label="anchor" href="#post-hoc-testing-for-lm-1"><i class="fas fa-link"></i></a>
</h2>
<p>Instead of using the <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> we will again use the <code><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht()</a></code> function from the <code>multcomp</code> package <span class="citation">(Hothorn, Bretz, and Westfall <a href="references.html#ref-multcomp" role="doc-biblioref">2008</a>)</span>.</p>
<p>A relatively simple way to make all the pairwise comparisons is to create a new factor variable that indicates membership of one of the four groups. We can do that with the <code><a href="https://rdrr.io/r/base/interaction.html">interaction()</a></code> function:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">periwinkle</span><span class="op">$</span><span class="va">seasxspp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">periwinkle</span><span class="op">$</span><span class="va">season</span>, <span class="va">periwinkle</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
para
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
season
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
species
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
seasxspp
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Spring.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
72
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
84
</td>
<td style="text-align:left;">
Spring
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Spring.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
88
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
81
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
88
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
73
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
74
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
89
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
74
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina brevicula
</td>
<td style="text-align:left;">
Summer.Littorina brevicula
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
79
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
86
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
97
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
81
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
85
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
59
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
Summer
</td>
<td style="text-align:left;">
Littorina littorea
</td>
<td style="text-align:left;">
Summer.Littorina littorea
</td>
</tr>
</tbody>
</table></div>
</div>
<p>We then rebuild the model using this one variable:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">periwinkle</span>, <span class="va">para</span> <span class="op">~</span> <span class="va">seasxspp</span><span class="op">)</span></code></pre></div>
<p>We have done a one-way ANOVA to obtain our post-hoc comparisons. The parameters in this model will be like those in a one-way ANOVA with <span class="math inline">\(\beta_{3}\)</span> giving the amount you add to the intercept to get the fourth group mean.</p>
<p>Load the package containing <code><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht()</a></code>:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org">multcomp</a></span><span class="op">)</span></code></pre></div>
<p>We have to specify our contrasts as a matrix with the <code>linfct</code> (linear functions) argument and there is a multiple comparisons function, <code><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp()</a></code>, to help.</p>
<p>This is the whole command:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span><span class="op">(</span><span class="va">mod2</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp</a></span><span class="op">(</span>seasxspp <span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>You can read this as “do all of the pairwise comparisons between each group in <code>seasxspp</code> in the model <code>mod</code> using the Tukey test”.</p>
<p>We view the results with <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_mc</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#    Simultaneous Tests for General Linear Hypotheses</span>
<span class="co"># </span>
<span class="co"># Multiple Comparisons of Means: Tukey Contrasts</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># Fit: lm(formula = para ~ seasxspp, data = periwinkle)</span>
<span class="co"># </span>
<span class="co"># Linear Hypotheses:</span>
<span class="co">#                                                              Estimate</span>
<span class="co"># Summer.Littorina brevicula - Spring.Littorina brevicula == 0    16.44</span>
<span class="co"># Spring.Littorina littorea - Spring.Littorina brevicula == 0      7.28</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina brevicula == 0     12.96</span>
<span class="co"># Spring.Littorina littorea - Summer.Littorina brevicula == 0     -9.16</span>
<span class="co"># Summer.Littorina littorea - Summer.Littorina brevicula == 0     -3.48</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina littorea == 0       5.68</span>
<span class="co">#                                                              Std. Error t value</span>
<span class="co"># Summer.Littorina brevicula - Spring.Littorina brevicula == 0       3.09    5.32</span>
<span class="co"># Spring.Littorina littorea - Spring.Littorina brevicula == 0        3.09    2.35</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina brevicula == 0        3.09    4.19</span>
<span class="co"># Spring.Littorina littorea - Summer.Littorina brevicula == 0        3.09   -2.96</span>
<span class="co"># Summer.Littorina littorea - Summer.Littorina brevicula == 0        3.09   -1.13</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina littorea == 0         3.09    1.84</span>
<span class="co">#                                                              Pr(&gt;|t|)    </span>
<span class="co"># Summer.Littorina brevicula - Spring.Littorina brevicula == 0   &lt;0.001 ***</span>
<span class="co"># Spring.Littorina littorea - Spring.Littorina brevicula == 0     0.093 .  </span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina brevicula == 0    &lt;0.001 ***</span>
<span class="co"># Spring.Littorina littorea - Summer.Littorina brevicula == 0     0.020 *  </span>
<span class="co"># Summer.Littorina littorea - Summer.Littorina brevicula == 0     0.675    </span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina littorea == 0      0.263    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># (Adjusted p values reported -- single-step method)</span></code></pre></div>
<p>The results are the same as for using <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> as we have done the same tests using a different function.</p>
<p>You can see what a contrasts matrix looks like by looking at the <code>linfct</code> variable of the <code>glht</code> object. You don’t need it now but in the future you may need to specify your own contrasts matrices so let’s have a quick look to aid your journey towards understanding:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_mc</span><span class="op">$</span><span class="va">linfct</span>
<span class="co">#                                                         (Intercept)</span>
<span class="co"># Summer.Littorina brevicula - Spring.Littorina brevicula           0</span>
<span class="co"># Spring.Littorina littorea - Spring.Littorina brevicula            0</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina brevicula            0</span>
<span class="co"># Spring.Littorina littorea - Summer.Littorina brevicula            0</span>
<span class="co"># Summer.Littorina littorea - Summer.Littorina brevicula            0</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina littorea             0</span>
<span class="co">#                                                         seasxsppSummer.Littorina brevicula</span>
<span class="co"># Summer.Littorina brevicula - Spring.Littorina brevicula                                  1</span>
<span class="co"># Spring.Littorina littorea - Spring.Littorina brevicula                                   0</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina brevicula                                   0</span>
<span class="co"># Spring.Littorina littorea - Summer.Littorina brevicula                                  -1</span>
<span class="co"># Summer.Littorina littorea - Summer.Littorina brevicula                                  -1</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina littorea                                    0</span>
<span class="co">#                                                         seasxsppSpring.Littorina littorea</span>
<span class="co"># Summer.Littorina brevicula - Spring.Littorina brevicula                                 0</span>
<span class="co"># Spring.Littorina littorea - Spring.Littorina brevicula                                  1</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina brevicula                                  0</span>
<span class="co"># Spring.Littorina littorea - Summer.Littorina brevicula                                  1</span>
<span class="co"># Summer.Littorina littorea - Summer.Littorina brevicula                                  0</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina littorea                                  -1</span>
<span class="co">#                                                         seasxsppSummer.Littorina littorea</span>
<span class="co"># Summer.Littorina brevicula - Spring.Littorina brevicula                                 0</span>
<span class="co"># Spring.Littorina littorea - Spring.Littorina brevicula                                  0</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina brevicula                                  1</span>
<span class="co"># Spring.Littorina littorea - Summer.Littorina brevicula                                  0</span>
<span class="co"># Summer.Littorina littorea - Summer.Littorina brevicula                                  1</span>
<span class="co"># Summer.Littorina littorea - Spring.Littorina littorea                                   1</span>
<span class="co"># attr(,"type")</span>
<span class="co"># [1] "Tukey"</span></code></pre></div>
<p>It is matrix with a column for each parameter, in order) and a row for each contrast containing only 0s, 1s and -1s. The rows are named.
The 0s, 1s and -1s indicate how the model parameters are needed to make the contrast and these can be understood by considering how the group means relate to the parameters.</p>
<ul>
<li>Spring.Littorina brevicula mean is <span class="math inline">\(\beta_{0}\)</span>
</li>
<li>Summer.Littorina brevicula mean is <span class="math inline">\(\beta_{0} + \beta_{1}\)</span>
</li>
<li>Spring.Littorina littorea <span class="math inline">\(\beta_{0} + \beta_{2}\)</span>
</li>
<li>Summer.Littorina littorea <span class="math inline">\(\beta_{0} + \beta_{3}\)</span>
</li>
</ul>
<p>Therefore:</p>
<ul>
<li>Summer.Littorina brevicula - Spring.Littorina brevicula is: <span class="math inline">\(\beta_{0} + \beta_{1} - \beta_{0} = \beta_{1}\)</span> and there is a one in the <code>seasxsppSummer.Littorina brevicula</code> column and zeros else where<br>
</li>
<li>Spring.Littorina littorea - Spring.Littorina brevicula is: <span class="math inline">\(\beta_{0} + \beta_{2} - \beta_{0} = \beta_{2}\)</span> and there is a one in the <code>seasxsppSpring.Littorina littorea</code> column and zeros else where<br>
</li>
<li>Summer.Littorina littorea - Spring.Littorina brevicula is: <span class="math inline">\(\beta_{0} + \beta_{3} - \beta_{0} = \beta_{3}\)</span> and there is a 1 in the the <code>seasxsppSummer.Littorina littorea</code> column and zeros else where<br>
</li>
<li>Spring.Littorina littorea - Summer.Littorina brevicula is: <span class="math inline">\(\beta_{0} + \beta_{2} - (\beta_{0} + \beta_{1}) = \beta_{2} - \beta_{1}\)</span> and there is a 1 in the the <code>seasxsppSpring.Littorina littorea</code> column and a -1 in the <code>seasxsppSummer.Littorina brevicula</code> column<br>
</li>
<li>Summer.Littorina littorea - Summer.Littorina brevicula is: <span class="math inline">\(\beta_{0} + \beta_{3} - (\beta_{0} + \beta_{1}) = \beta_{3} - \beta_{1}\)</span> and there is a 1 in the the <code>seasxsppSummer.Littorina littorea</code> column and a -1 in the <code>seasxsppSummer.Littorina brevicula</code> column<br>
</li>
<li>Summer.Littorina littorea - Spring.Littorina littorea is: <span class="math inline">\(\beta_{0} + \beta_{3} - (\beta_{0} + \beta_{2}) = \beta_{3} + \beta_{2}\)</span> and there is a 1 in the the <code>seasxsppSummer.Littorina littorea</code> column and column and a -1 in the <code>seasxsppSpring.Littorina littorea</code> column</li>
</ul>
</div>
<div id="creating-a-figure-3" class="section level2">
<h2>
<span class="header-section-number">7.9</span> Creating a figure<a class="anchor" aria-label="anchor" href="#creating-a-figure-3"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># palette</span>
<span class="co"># blue, pink, green triadic</span>
<span class="va">pal4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#256c7a"</span>, <span class="st">"#7a256c"</span>, <span class="st">"#6c7a25"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">periwinkle</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">season</span>,
                                    y <span class="op">=</span> <span class="va">para</span>,
                                    colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
             position <span class="op">=</span> <span class="fu">position_jitterdodge</span><span class="op">(</span>dodge.width <span class="op">=</span> <span class="fl">1</span>,
                                             jitter.width <span class="op">=</span> <span class="fl">0.4</span>,
                                             jitter.height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">peri_summary</span>, 
                <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">season</span>, ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="va">se</span>, ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="va">se</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
                width <span class="op">=</span> <span class="fl">0.4</span>, size <span class="op">=</span> <span class="fl">1</span>,
                position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">peri_summary</span>, 
                <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">season</span>, ymin <span class="op">=</span> <span class="va">mean</span>, ymax <span class="op">=</span> <span class="va">mean</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
                width <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">1</span>,
                position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Season"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of parasites"</span>,
                     expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">128</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal4</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,
                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="st">"L.brevicula"</span><span class="op">)</span><span class="op">)</span>,
                                 <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="st">"L.littorea"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Spring:Littorina brevicula-Summer:Littorina littorea *</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>, 
           x <span class="op">=</span> <span class="fl">1.25</span>, xend <span class="op">=</span> <span class="fl">1.75</span>, 
           y <span class="op">=</span> <span class="fl">110</span>, yend <span class="op">=</span> <span class="fl">110</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>, 
           x <span class="op">=</span> <span class="fl">1.25</span>, xend <span class="op">=</span> <span class="fl">1.25</span>,
           y <span class="op">=</span> <span class="fl">110</span>, yend <span class="op">=</span> <span class="fl">105</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>, 
           x <span class="op">=</span> <span class="fl">1.75</span>, xend <span class="op">=</span> <span class="fl">1.75</span>,
           y <span class="op">=</span> <span class="fl">110</span>, yend <span class="op">=</span> <span class="fl">105</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, 
           x <span class="op">=</span> <span class="fl">1.5</span>,  y <span class="op">=</span> <span class="fl">112</span>,
           label <span class="op">=</span> <span class="st">"***"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Summer:Littorina brevicula-Spring:Littorina littorea: ***</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>, 
           x <span class="op">=</span> <span class="fl">1.25</span>, xend <span class="op">=</span> <span class="fl">0.75</span>,
           y <span class="op">=</span> <span class="fl">90</span>, yend <span class="op">=</span> <span class="fl">90</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>, 
           x <span class="op">=</span> <span class="fl">1.25</span>, xend <span class="op">=</span> <span class="fl">1.25</span>,
           y <span class="op">=</span> <span class="fl">90</span>, yend <span class="op">=</span> <span class="fl">85</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>, 
           x <span class="op">=</span> <span class="fl">0.75</span>, xend <span class="op">=</span> <span class="fl">0.75</span>,
           y <span class="op">=</span> <span class="fl">90</span>, yend <span class="op">=</span> <span class="fl">85</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span>,  y <span class="op">=</span> <span class="fl">92</span>,
           label <span class="op">=</span> <span class="st">"*"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
<span class="co"># Summer:Littorina littorea-Spring:Littorina littorea: ***</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>,
           x <span class="op">=</span> <span class="fl">0.75</span>, xend <span class="op">=</span> <span class="fl">1.75</span>,
           y <span class="op">=</span> <span class="fl">120</span>, yend <span class="op">=</span> <span class="fl">120</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>,
           x <span class="op">=</span> <span class="fl">0.75</span>, xend <span class="op">=</span> <span class="fl">0.75</span>,
           y <span class="op">=</span> <span class="fl">120</span>, yend <span class="op">=</span> <span class="fl">115</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"segment"</span>,
           x <span class="op">=</span> <span class="fl">1.75</span>, xend <span class="op">=</span> <span class="fl">1.75</span>,
           y <span class="op">=</span> <span class="fl">120</span>, yend <span class="op">=</span> <span class="fl">115</span>,
           colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.25</span>,  y <span class="op">=</span> <span class="fl">123</span>,
           label <span class="op">=</span> <span class="st">"***"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.98</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="two-way-anova-revisit_files/figure-html/fig-two-anova-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
</div>
<div id="reporting-the-results-3" class="section level2">
<h2>
<span class="header-section-number">7.10</span> Reporting the results<a class="anchor" aria-label="anchor" href="#reporting-the-results-3"><i class="fas fa-link"></i></a>
</h2>
<p><em>to add</em></p>
<p>See figure <a href="two-way-anova-revisit.html#fig:fig-two-anova-report">7.4</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:fig-two-anova-report"></span>
<img src="two-way-anova-revisit_files/figure-html/fig-two-anova-report-1.png" alt="The effect of season on the parasite load of two species of periwinkle. Error bars are \(\pm 1 S.E.\). *** significant difference at the \(p &lt; 0.001\) level, ** at the \(p &lt; 0.01\) level and * the \(p &lt; 0.05\) level." width="60%"><p class="caption">
Figure 7.4: The effect of season on the parasite load of two species of periwinkle. Error bars are <span class="math inline">\(\pm 1 S.E.\)</span>. *** significant difference at the <span class="math inline">\(p &lt; 0.001\)</span> level, ** at the <span class="math inline">\(p &lt; 0.01\)</span> level and * the <span class="math inline">\(p &lt; 0.05\)</span> level.
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="one-way-anova-revisit.html"><span class="header-section-number">6</span> One-way ANOVA revisited</a></div>
<div class="next"><a href="summary.html"><span class="header-section-number">8</span> Summary</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#two-way-anova-revisit"><span class="header-section-number">7</span> Two-way ANOVA revisited</a></li>
<li><a class="nav-link" href="#introduction-to-the-example-3"><span class="header-section-number">7.1</span> Introduction to the example</a></li>
<li><a class="nav-link" href="#aov-output-reminder-1"><span class="header-section-number">7.2</span> aov() output reminder</a></li>
<li><a class="nav-link" href="#post-hoc-testing-for-aov-1"><span class="header-section-number">7.3</span> Post-hoc testing for aov</a></li>
<li><a class="nav-link" href="#two-way-anovas-as-linear-models"><span class="header-section-number">7.4</span> Two-way ANOVAs as linear models</a></li>
<li><a class="nav-link" href="#applying-and-interpreting-lm-3"><span class="header-section-number">7.5</span> Applying and interpreting lm()</a></li>
<li><a class="nav-link" href="#getting-predictions-from-the-model-3"><span class="header-section-number">7.6</span> Getting predictions from the model</a></li>
<li><a class="nav-link" href="#checking-assumptions-4"><span class="header-section-number">7.7</span> Checking assumptions</a></li>
<li><a class="nav-link" href="#post-hoc-testing-for-lm-1"><span class="header-section-number">7.8</span> Post-hoc testing for lm()</a></li>
<li><a class="nav-link" href="#creating-a-figure-3"><span class="header-section-number">7.9</span> Creating a figure</a></li>
<li><a class="nav-link" href="#reporting-the-results-3"><span class="header-section-number">7.10</span> Reporting the results</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>gist-lm: Get Introductory Statistical Tests as Linear models: A guide for R users</strong>" was written by Emma Rand. It was last built on September 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
